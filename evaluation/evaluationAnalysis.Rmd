---
title: "Evaluation Analysis"
author: "Olivia Imner"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r, message = FALSE}
#PACKAGES
packages <- c(
  "printr",
  "ggthemes",
  "tidyverse",
  "readxl"
)
purrr::walk(packages, library, character.only = TRUE)
rm(packages)
```

```{r}
#read data
data <- read_excel(path = "~/Github/thesis_document/evaluation/evaluationResultsOfficial.xlsx")
```

### Score as a function of Phase

```{r, fig.align="center", fig.width=8, fig.height=6, message = FALSE}
figure2a <- data %>% 
  mutate(Phase = case_when(
    Phase == "Bedömning och utvärderings fas" ~ "Bedömning och\nutvärderings fas",
    Phase == "Övervakning och återkoppling fas" ~ "Övervakning och\nåterkoppling fas",
    TRUE ~ Phase
  )) %>%
  mutate(Phase = parse_factor(Phase, levels = c(
    "Presentation fas", "Praktik fas", 
    "Bedömning och\nutvärderings fas", "Övervakning och\nåterkoppling fas"
  ))) %>%
  ggplot() +
  geom_dotplot(
    aes(Phase, `Score (0-5)`),
    binwidth = 0.1, binaxis = "y", binpositions = "bygroup", stackdir = "center", 
    position = position_dodge(), dotsize = 1.5
  ) +
  geom_point(
    data = . %>%
      group_by(Phase) %>%
      summarize(mean = mean(`Score (0-5)`)),
    aes(Phase, mean), shape = 95, size = 10, colour = "grey30"
  ) +
  geom_linerange(
    data = . %>%
      group_by(Phase) %>%
      summarize(
        sd.l = mean(`Score (0-5)`) - sd(`Score (0-5)`),
        sd.h = mean(`Score (0-5)`) + sd(`Score (0-5)`)
      ),
    aes(Phase, ymin = sd.l, ymax = sd.h), colour = "grey30"
  ) +
  scale_y_continuous(breaks = seq(0, 6, 1)) +
  labs(x = "Fas", y = "Poäng (0-5)") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90), legend.position = "top")

figure2a

ggsave(
  plot = figure2a,
  filename = 'figure2a.pdf',
  device = cairo_pdf
  #,
  #height = 60,
  #width = 93,
  #units = "mm"
)
```

### Score as a function of Phase and Element

```{r, fig.align="center", fig.width=8, fig.height=6, message = FALSE}
figure2b <- data %>%
  mutate(Element = parse_factor(Element, levels = unique(Element))) %>%
  mutate(Phase = str_replace(Phase, "(.*).{4}$", "\\1")) %>%
  mutate(Phase = parse_factor(
    Phase, 
    levels = c("Presentation", "Praktik", "Övervakning och återkoppling", "Bedömning och utvärderings")
  )) %>%
  ggplot() +
  geom_dotplot(
    aes(Element, `Score (0-5)`, fill = Phase),
    binwidth = 0.1, binaxis = "y", binpositions = "bygroup", stackdir = "center", 
    position = position_dodge(), dotsize = 1.5
  ) +
  geom_point(
    data = . %>%
      group_by(Element) %>%
      summarize(mean = mean(`Score (0-5)`)),
    aes(Element, mean), shape = 95, size = 10, colour = "grey30"
  ) +
  geom_linerange(
    data = . %>%
      group_by(Element) %>%
      summarize(
        sd.l = mean(`Score (0-5)`) - sd(`Score (0-5)`),
        sd.h = mean(`Score (0-5)`) + sd(`Score (0-5)`)
      ),
    aes(Element, ymin = sd.l, ymax = sd.h), colour = "grey30"
  ) +
  scale_y_continuous(breaks = seq(0, 5, 1)) +
  labs(y = "Poäng (0-5)") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90), legend.position = "top") +
  guides(fill = guide_legend(title = "Fas"))

figure2b

ggsave(
  plot = figure2b,
  filename = 'figure2b.pdf',
  device = cairo_pdf
  #,
  #height = 60,
  #width = 93,
  #units = "mm"
)
```

### Score as a function of Course

```{r, fig.align="center", fig.width=8, fig.height=6, message = FALSE}
figure2c <- data %>% 
  ggplot() +
  geom_dotplot(
    aes(Course, `Score (0-5)`),
    binwidth = 0.1, binaxis = "y", binpositions = "bygroup", stackdir = "center", 
    position = position_dodge(), dotsize = 1.5
  ) +
  geom_point(
    data = . %>%
      group_by(Course) %>%
      summarize(mean = mean(`Score (0-5)`)),
    aes(Course, mean), shape = 95, size = 10, colour = "grey30"
  ) +
  geom_linerange(
    data = . %>%
      group_by(Course) %>%
      summarize(
        sd.l = mean(`Score (0-5)`) - sd(`Score (0-5)`),
        sd.h = mean(`Score (0-5)`) + sd(`Score (0-5)`)
      ),
    aes(Course, ymin = sd.l, ymax = sd.h), colour = "grey30"
  ) +
  scale_y_continuous(breaks = seq(0, 6, 1)) +
  labs(x = "Kurs", y = "Poäng (0-5)") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90), legend.position = "top")

figure2c

ggsave(
  plot = figure2c,
  filename = 'figure2c.pdf',
  device = cairo_pdf
  #,
  #height = 60,
  #width = 93,
  #units = "mm"
)
```

### Score as a function of Phase and Course

```{r, fig.align="center", fig.width=8, fig.height=6, message = FALSE}
figure2d <- data %>% 
  mutate(Phase = str_replace(Phase, "(.*).{4}$", "\\1")) %>%
  mutate(Phase = parse_factor(
    Phase, 
    levels = c(
      "Presentation", "Praktik", "Övervakning och återkoppling", 
      "Bedömning och utvärderings"
    )
  )) %>%
  ggplot() +
  geom_dotplot(
    aes(Course, `Score (0-5)`, fill = Course, group = interaction(Course, Phase)),
    binwidth = 0.1, binaxis = "y", binpositions = "bygroup", stackdir = "center", 
    position = position_dodge(), dotsize = 1.5
  ) +
  geom_point(
    data = . %>%
      group_by(Course, Phase) %>%
      summarize(mean = mean(`Score (0-5)`)),
    aes(Course, mean), shape = 95, size = 10, colour = "grey30"
  ) +
  geom_linerange(
    data = . %>%
      group_by(Course, Phase) %>%
      summarize(
        sd.l = mean(`Score (0-5)`) - sd(`Score (0-5)`),
        sd.h = mean(`Score (0-5)`) + sd(`Score (0-5)`)
      ),
    aes(Course, ymin = sd.l, ymax = sd.h), colour = "grey30"
  ) +
  facet_wrap(~Phase) +
  scale_y_continuous(breaks = seq(0, 6, 1)) +
  labs(x = "Kurs", y = "Poäng (0-5)") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90), legend.position = "top") +
  guides(fill = FALSE)

figure2d

ggsave(
  plot = figure2d,
  filename = 'figure2d.pdf',
  device = cairo_pdf
  #,
  #height = 60,
  #width = 93,
  #units = "mm"
)
```
