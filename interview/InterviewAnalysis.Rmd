---
title: "Interview Analysis"
author: "Olivia Imner"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r, message = FALSE}
#PACKAGES
packages <- c(
  "printr",
  "ggthemes",
  "tidyverse",
  "readxl"
)
purrr::walk(packages, library, character.only = TRUE)
rm(packages)
```

```{r}
#read data
data <- read_excel(path = "~/Github/thesis_document/interview/interviewScores.xlsx") %>%
  mutate(Nr = parse_factor(Nr, levels = unique(Nr))) %>%
  mutate(Section = if_else(Section == "Användarbarhet och feedback på prestation", "Användarbarhet och feedback\npå prestation", Section)) %>%
  mutate(Section = parse_factor(Section, levels = unique(Section)))
```

```{r, fig.align="center", fig.width=10, fig.height=8}
figure1 <- data %>%
  ggplot() +
  geom_bar(aes(Nr, Poäng, fill = Modell), stat = "identity") +
  facet_wrap(~Section, scales = "free_x") +
  theme_bw() +
  scale_fill_ptol() +
  labs(x = "Question Number") +
  theme(legend.position = "top")

figure1
#ggsave(figure1, file = "figure1.pdf")
```

```{r}
data %>% 
  group_by(Modell) %>% 
  summarize(
    `Sum of Points` = sum(Poäng),
    `Median Points` = median(Poäng),
    `Mean Points` = mean(Poäng)
  )
```

```{r, fig.align="center", fig.width=10, fig.height=8}
figure2 <- data %>%
  ggplot() +
  geom_boxplot(aes(Modell, Poäng, fill = Modell)) +
  theme_bw() +
  scale_fill_ptol()

figure2
#ggsave(figure2, file = "figure2.pdf")
```

